"use strict";(self.webpackChunksample_template_webpack=self.webpackChunksample_template_webpack||[]).push([[910],{579:function(e,t,i){i.d(t,{BG:function(){return l},Md:function(){return d},Xc:function(){return r},_s:function(){return c},bZ:function(){return o},dK:function(){return n},fc:function(){return p},fv:function(){return u},oQ:function(){return h},wO:function(){return m},yR:function(){return s}});var a=i(316);let r=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.ExtendedHours=t.ExtendedHours||function(e){var i=e.stx;this.filter=e.filter,i||(i=e,this.filter=!1);var a={};this.stx=i,this.stx.extendedHours=this,this.cssRequired=!0,i.addEventListener("theme",(function(e){for(var t in a={},i.layout.marketSessions)a.session||(a.session={}),a.session[t]=i.canvasStyle("stx_market_session "+t)})),i.addEventListener("symbolChange",(function(e){"master"!=e.action||!i.layout.extended||i.chart.market.market_def&&i.chart.market.sessions.length||t.alert("There are no Extended Hours for this instrument.")})),t.UI&&t.UI.KeystrokeHub.addHotKeyHandler("extendedHours",(({stx:e})=>{e.container.ownerDocument.body.keystrokeHub.context.advertised.Layout.setExtendedHours()}),i),this.prepare=function(e,t){for(var r in i.layout.extended=e,i.layout.marketSessions)a.session={},i.chart.market.disableSession(r);if(i.layout.marketSessions={},e)if(t||(t=["pre","post"]),t.length)for(var n=0;n<t.length;n++)i.layout.marketSessions[t[n]]=!0;else i.layout.marketSessions=t;for(r in i.layout.marketSessions)a.session||(a.session={}),a.session[r]=i.canvasStyle("stx_market_session "+r),i.chart.market.disableSession(r,!0)},this.complete=function(e){i.changeOccurred("layout"),i.chart.market.market_def?this.filter?(i.createDataSet(),i.draw(),e&&e()):i.loadChart(i.chart.symbol,e):e&&e()},this.set=function(e,t,i){this.prepare(e,t),this.complete(i)},this.stx.append("drawYAxis",(function(e,r){if(this.layout.extended&&e.yAxis==r.yAxis&&!1!==e.shareChartXAxis&&!e.hidden){var n=e.chart;if(!t.ChartEngine.isDailyInterval(this.layout.interval)&&(a.divider=this.canvasStyle("stx_market_session divider"),a.session)){for(var s,o,l=n.market,c=[],d={},h=0;h<n.dataSegment.length;h++){var u=n.dataSegment[h];if(u&&u.DT){var m=null;if(l.market_def)if(!s||s<=u.DT)o=l.getSession(u.DT),s=l[!(""===o||this.layout.marketSessions&&this.layout.marketSessions[o])?"getNextOpen":"getNextClose"](u.DT);var p=a.session[o];if(p&&(m=p.backgroundColor),d.color&&d.color!=m&&(c.push({start:d.start,end:d.end,color:d.color}),d={}),m){var f=this.layout.candleWidth;u.candleWidth&&(f=u.candleWidth),d.end=this.pixelFromBar(h,n)+f/2,d.start||0===d.start||(d.start=d.end-f+1),d.color=m}else d={}}}(d.start||0===d.start)&&c.push({start:d.start,end:d.end,color:d.color});var y=t.isTransparent(a.divider.backgroundColor),v=a.divider.width.replace(/px/g,""),g={y0:e.bottom,y1:e.top,color:a.divider.backgroundColor,type:"line",context:n.context,confineToPanel:e,pattern:"dashed",lineWidth:v,deferStroke:!0};for(this.startClip(e.name),n.context.beginPath(),i.highlightedDraggable&&(n.context.globalAlpha*=.3),h=0;h<c.length;h++)n.context.fillStyle=c[h].color,!y&&c[h].start>n.left&&this.plotLine(t.extend({x0:c[h].start,x1:c[h].start},g)),n.context.fillRect(c[h].start,e.top,c[h].end-c[h].start,e.bottom-e.top),!y&&c[h].end<n.right&&this.plotLine(t.extend({x0:c[h].end,x1:c[h].end},g));n.context.stroke(),this.endClip()}}}))}},n=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.FullScreen=t.FullScreen||function(e){if(e||(e={}),e.stx){try{if(window.location.host!==window.top.location.host)throw new Error(window.location.host+" does not match "+window.top.location.host)}catch(e){return void console.warn("Full screen mode disabled.")}this.stx=e.stx,this.stx.fullScreen=this,this.fullScreenButton=null,this.fullScreenState=!1,this.addFullScreenButton=function(){this.stx.registerChartControl&&(this.fullScreenButton=this.stx.registerChartControl("stx-full-screen","Full Screen",function(e){return function(t){e.fullScreenToggle(t),t.stopPropagation()}}(this)))},this.fullScreenToggle=function(e){var t=e.target.ownerDocument;t.documentElement.requestFullscreen||t.documentElement.webkitRequestFullscreen||t.documentElement.mozRequestFullscreen||t.documentElement.msRequestFullscreen?this.getFullScreenElement(t)?t.exitFullscreen?t.exitFullscreen():t.webkitExitFullscreen?t.webkitExitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.msExitFullscreen&&t.msExitFullscreen():t.documentElement.requestFullscreen?t.documentElement.requestFullscreen():t.documentElement.webkitRequestFullscreen?t.documentElement.webkitRequestFullscreen():t.documentElement.mozRequestFullscreen?t.documentElement.mozRequestFullscreen():t.documentElement.msRequestFullscreen&&t.documentElement.msRequestFullscreen():(this.fullScreenState=!this.fullScreenState,this.fullScreenRender())},this.fullScreenRender=function(){var e=null;(e=this.stx.container.closest("*[cq-context], cq-context, body"))&&(!0===this.fullScreenState?(this.fullScreenButton&&this.fullScreenButton.classList.add("active"),e.classList.add("full-screen")):(this.fullScreenButton&&this.fullScreenButton.classList.remove("active"),e.classList.remove("full-screen")),window.dispatchEvent(new Event("resize")))},this.onFullScreenChange=function(e){this.getFullScreenElement(e.target.ownerDocument)?this.fullScreenState=!0:this.fullScreenState=!1,this.fullScreenRender()},this.getFullScreenElement=function(e){return e.fullscreenElement||e.webkitCurrentFullScreenElement||e.mozFullScreenElement||e.msFullscreenElement};var t=this;["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"].forEach((function(e){t.stx.container.ownerDocument.addEventListener(e,t.onFullScreenChange.bind(t))})),this.addFullScreenButton()}else console.warn("The Full Screen addon requires an stx parameter")}},s=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.InactivityTimer=t.InactivityTimer||function(e){if(e.minutes){(!e.interval||e.interval<0)&&(e.interval=60),this.stx=e.stx,this.timeout=e.minutes,this.interval=e.interval,this.wakeCB=e.wakeCB,this.sleepCB=e.sleepCB,this.sleepTimer=null,this.sleeping=!1,this.last=(new Date).getTime(),this.wakeChart=function(i){clearTimeout(this.sleepTimer),this.last=(new Date).getTime(),this.sleeping&&(this.stx.quoteDriver&&this.stx.quoteDriver.updateChartLoop(),this.sleeping=!1,this.stx.container.ownerDocument.body.classList.remove("ciq-sleeping"),i||t.ChartEngine.registeredContainers.forEach((function(t){e.stx!==t.stx&&t.stx.inactivityTimer&&t.stx.inactivityTimer.wakeChart(!0)}))),this.sleepTimer=setTimeout(this.sleepChart.bind(this),6e4*this.timeout),this.wakeCB&&this.wakeCB()},this.sleepChart=function(i){this.sleeping||(this.stx.quoteDriver&&this.stx.quoteDriver.updateChartLoop(this.interval),this.sleeping=!0,this.stx.container.ownerDocument.body.classList.add("ciq-sleeping"),i||t.ChartEngine.registeredContainers.forEach((function(t){e.stx!==t.stx&&t.stx.inactivityTimer&&t.stx.inactivityTimer.sleepChart(!0)}))),this.sleepCB&&this.sleepCB()};var i=this;["mousemove","mousedown","touchstart","touchmove","pointerdown","pointermove","keydown","wheel"].forEach((function(e){i.stx.container.ownerDocument.addEventListener(e,a,{passive:!1})})),this.stx.inactivityTimer=this,this.wakeChart()}function a(){i.wakeChart()}}},o=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.RangeSlider=t.RangeSlider||function(e){this.cssRequired=!0;var i=e.stx;i.slider=this;var a=e.height?e.height:"95px",r=e.chartContainer?e.chartContainer:e.stx.container,n=document.createElement("div");n.className="ciq-chart";var s=document.createElement("div");s.className="chartContainer",n.appendChild(s),r.parentElement.parentElement.insertBefore(n,r.parentElement.nextSibling),Object.assign(n.style,{height:a,paddingTop:"5px",display:"none"}),s.style.height="100%",s.dimensionlessCanvas=!0;var o=this.slider=new t.ChartEngine({container:s,preferences:{labels:!1,whitespace:0}});o.xaxisHeight=30,o.manageTouchAndMouse=!1,o.minimumCandleWidth=0,o.chart.yaxisMarginMultiplier=1;var l=o.chart.panel,c=l.subholder,d=l.close;c.style.cursor="ew-resize",c.classList.add("stx_range_slider"),d&&(d.style.display="inline",t.safeClickTouch(d,(function(){i.layout.rangeSlider=!1,i.changeOccurred("layout")})));var h=l.yAxis;h.drawCurrentPriceLabel=!1,Object.defineProperty(h,"position",{get:function(){return i.slider.yAxisPosition||i.chart.panel.yAxis.position},set:function(e){i.slider.yAxisPosition=e}});const{get:u,set:m}=Object.getOwnPropertyDescriptor(t.ChartEngine.YAxis.prototype,"width");Object.defineProperty(h,"width",{get:function(){return Math.max(u.call(h),i.chart.yAxis.width)},set:function(e){m.call(h,e)}}),t.extend(h,e.yAxis),o.chart.baseline.userLevel=!1,o.controls.home&&(o.controls.home.style.width=0),o.initializeChart(),t.UI&&(t.UI.KeystrokeHub.addHotKeyHandler("rangeSlider",(({stx:e})=>{e.container.ownerDocument.body.keystrokeHub.context.advertised.Layout.setRangeSlider()}),i),t.UI.observeProperty("breakpoint",i.chart,(e=>o.notifyBreakpoint(e.value)))),this.updateStyles=function(e,t,a){i.setStyle(e,t,a),this.style=i.canvasStyle("stx_range_slider shading")},this.display=function(e){if(i.layout.rangeSlider!==e)return i.layout.rangeSlider=e,void i.changeOccurred("layout");n.style.display=e?"":"none",i.resizeChart(),n.ownerDocument.defaultView.dispatchEvent(new Event("resize")),e&&(o.resizeChart(),o.initializeChart(),this.requestDraw())},this.setSymbol=function(e){o.chart.panel.display=o.chart.symbol=e,o.chart.symbolObject={symbol:e},o.chart.market=i.chart.market,o.setMainSeriesRenderer(),o.resizeChart(),this.adjustRange(i.chart),this.requestDraw()},this.acceptLayoutChange=function(e){var a=!1;o.layout.rangeSlider!==e.rangeSlider&&i.slider.display(e.rangeSlider);["chartType","aggregationType","periodicity","interval","timeUnit","chartScale","rangeSlider","flipped","extended","marketSessions","kagi","rangebars","renko","priceLines","pandf"].forEach((function(i){t.equals(o.layout[i],e[i])||(o.layout[i]=e[i],a=!0)})),t.trulyVisible(n)&&a&&(o.setMainSeriesRenderer(),this.requestDraw())},this.adjustRange=function(e){if(e.dataSet&&e.endPoints&&e.endPoints.begin){var t=o.chart;if(t.width){var a=0,r=0;if(i.quoteDriver){var n={symbol:e.symbol,symbolObject:e.symbolObject,interval:i.layout.interval};"month"!=n.interval&&"week"!=n.interval||i.dontRoll||(n.interval="day");var s=i.quoteDriver.getQuoteFeed(n).behavior;s&&s.bufferSize&&(e.moreAvailable&&(a=s.bufferSize),i.isHistoricalMode()&&(r=s.bufferSize))}t.baseline.defaultLevel=e.baseline.actualLevel,t.scroll=Math.max(0,e.dataSet.length-i.tickFromDate(e.endPoints.begin)-a)+1,o.setMaxTicks(t.scroll-r+2)}}},this.copyData=function(e){if(e.dataSet&&e.masterData){var t=o.chart;t.masterData=o.masterData=e.masterData.slice(0),t.dataSet=e.dataSet.slice(0),t.state=e.state,this.requestDraw()}},this.calculateYAxisPosition=function(){var e=o.chart.panel;o.getYAxisCurrentPosition(e.yAxis,e)!=e.yAxis.position&&o.calculateYAxisPositions()},this.drawSlider=function(){if(t.trulyVisible(n)&&i.chart.dataSet&&i.chart.dataSet.length){var e=this.style;e||(e=this.style=i.canvasStyle("stx_range_slider shading"));var a=i.chart.panel,r=o.chart.context,s=o.chart.segmentImage||[],l=o.layout.candleWidth/2,d=o.tickLeft=Math.max(i.tickFromPixel(a.left+l),0),h=o.tickRight=Math.min(i.tickFromPixel(a.right-l),i.chart.dataSet.length-1),u=o.pixelLeft=o.pixelFromTick(d)-(s[d]?s[d].candleWidth/2:l),m=o.pixelRight=o.pixelFromTick(h)+(s[h]?s[h].candleWidth/2:l),p=c.offsetLeft,f=p+c.offsetWidth;r.save(),r.beginPath(),r.fillStyle=e.backgroundColor,r.fillRect(p,c.offsetTop,u-p,c.offsetHeight),r.fillRect(f,c.offsetTop,m-f,c.offsetHeight),r.strokeStyle=e.borderTopColor,r.lineWidth=parseInt(e.borderWidth,10),r.moveTo(u,c.offsetTop),r.lineTo(u,c.offsetTop+c.offsetHeight),r.moveTo(m,c.offsetTop),r.lineTo(m,c.offsetTop+c.offsetHeight),r.stroke(),r.beginPath(),r.lineWidth=parseInt(e.width,10),r.lineCap="round",r.moveTo(u,c.offsetTop+c.offsetHeight/4),r.lineTo(u,c.offsetTop+3*c.offsetHeight/4),r.moveTo(m,c.offsetTop+c.offsetHeight/4),r.lineTo(m,c.offsetTop+3*c.offsetHeight/4),r.stroke(),r.restore()}},this.requestDraw=function(){this.drawRequested||(this.drawRequested=setTimeout((()=>{o.draw(),this.drawSlider(),this.drawRequested=clearTimeout(this.drawRequested)}),100))},i.addEventListener("layout",(function(e){e.stx.slider.acceptLayoutChange(e.stx.layout)})),i.addEventListener("preferences",(function(e){const{language:i}=e.stx.preferences;t.I18N&&o.preferences.language!=i&&t.I18N.setLocale(o,i),o.preferences.language=i,this.slider.requestDraw()})),i.addEventListener("symbolChange",(function(e){"master"==e.action&&e.stx.slider.setSymbol(e.symbol)})),i.addEventListener("symbolImport",(function(e){"master"==e.action&&e.stx.slider.setSymbol(e.symbol),e.stx.slider.acceptLayoutChange(e.stx.layout)})),i.addEventListener("theme",(function(e){if(o.clearPixelCache(),o.styles={},o.container.style.backgroundColor="",t.ThemeHelper){var i=new t.ThemeHelper({stx:e.stx});i.params.stx=o,i.update()}})),i.append("createDataSet",(function(...e){const[,,{animationEntry:t}={}]=e||[];t||(this.slider.adjustRange(this.chart),this.slider.copyData(this.chart))})),i.append("draw",(function({animationEntry:e}={}){!e&&t.trulyVisible(n)&&o.chart.dataSet&&(this.slider.calculateYAxisPosition(),this.slider.adjustRange(this.chart),this.slider.requestDraw())})),i.prepend("resizeChart",(function(){var e=r.parentElement;if(!e||!e.isConnected)return!0;var i=e.parentElement,a=t.elementDimensions(i).height,s=i.querySelectorAll(".chartContainer");Array.from(s).forEach((function(e){e!==r&&t.trulyVisible(e)&&(a-=t.elementDimensions(e.parentElement,{border:1,padding:1,margin:1}).height)})),e.style.height=a+"px",this.layout.rangeSlider?(n.style.display="",o.resizeChart(),o.initializeChart(),this.slider.requestDraw()):n.style.display="none"})),["mousedown","touchstart","pointerdown"].forEach((function(e){c.addEventListener(e,(function(e){var a=o.backOutX(e.pageX);if(a||0===a){a-=e.target.offsetLeft,o.startDrag=a,o.startPixelLeft=o.pixelLeft,o.startPixelRight=o.pixelRight;var r=i.slider.style;r||(r=i.slider.style=i.canvasStyle("stx_range_slider shading"));var n=parseInt(r.borderLeftWidth,10);(a+=this.offsetLeft)<o.pixelRight-n&&(o.needsLeft=!0),a>o.pixelLeft+n&&(o.needsRight=!0),t.touchDevice||o.needsLeft&&o.needsRight&&e.target.classList.add("stx-drag-chart")}}),{passive:!1})})),["mouseup","mouseover","touchend","pointerup"].forEach((function(e){c.addEventListener(e,(function(e){const{which:t,type:i}=e;1===t&&"pointerup"!==i&&"mouseup"!==i||(e.target.classList.remove("stx-drag-chart"),o.chart.panel.subholder.style.cursor="ew-resize",o.startDrag=null,o.needsLeft=!1,o.needsRight=!1)}))})),["mousemove","touchmove","pointermove"].forEach((function(e){c.addEventListener(e,(function(e){o.timeout||(o.timeout=setTimeout((()=>{const t=()=>o.timeout=clearTimeout(o.timeout),{startDrag:a,startPixelLeft:r,startPixelRight:n,needsLeft:s,needsRight:l}=o;let{tickLeft:c,tickRight:d}=o;if(!a&&0!==a)return t();const{touches:h}=e;let u=(h&&h.length?o.backOutX(h[0].pageX):o.backOutX(e.pageX))-e.target.offsetLeft;if(!u&&0!==u)return t();if(u-=a,s)r+u<o.chart.left&&(u=o.chart.left-r),l&&n+u>=o.chart.right&&(u=o.chart.right-n,o.isHome()||(u+=o.layout.candleWidth/2)),c=o.tickFromPixel(r+u),l&&(d=c+o.tickRight-o.tickLeft);else{if(!l)return t();d=Math.min(o.tickFromPixel(n+u),i.chart.dataSet.length-1)}let m=i.chart.width/(d-c+1);d>=c&&(s&&l||m>=i.minimumCandleWidth)&&(o.tickLeft=c,o.tickRight=d,i.chart.scroll=i.chart.dataSet.length-c,s&&l||i.setCandleWidth(m),i.micropixels=0,i.draw()),t()})))}),{passive:!1})})),this.adjustRange(i.chart),this.copyData(i.chart),i.draw()}},l=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.Shortcuts=t.Shortcuts||function({stx:e,width:i=580,windowForEachChart:a=!0,config:r}={}){if(!e)return void console.warn("The Shortcuts addon requires an stx parameter");this.stx=e,this.width=i,this.windowForEachChart=a,this.content=this.getShortcutContent(r),this.ensureMessagingAvailable(e),this.enableUI(e),this.cssRequired=!0,e.shortcuts=this,t.UI&&t.UI.KeystrokeHub.addHotKeyHandler("shortcuts",(({stx:e,options:t})=>{e.container.ownerDocument.body.keystrokeHub.context.advertised.Layout.showShortcuts()}),e);const n=this.stx.container.closest("cq-context"),s=new MutationObserver((()=>this.content=this.getShortcutContent(r)));s.observe(n,{attributes:!0}),this.mo=s},t.Shortcuts.prototype.enableUI=function(e){e&&t.UI&&setTimeout((()=>{e.uiContext.getAdvertised("Layout").showShortcuts=(e,t)=>this.toggle(t)}))},t.Shortcuts.prototype.ensureMessagingAvailable=function(e){setTimeout((()=>{const t=e.uiContext.topNode;Array.from(t.querySelectorAll("cq-floating-window")).find((e=>e.closest("cq-context")===t))||t.append(document.createElement("cq-floating-window"))}))},t.Shortcuts.prototype.getShortcutContent=function(e){const t=(e.drawingTools||[]).filter((e=>e.shortcut)).map((({label:e,shortcut:t})=>`<div class="ciq-shortcut">\n\t\t\t\t\t<div>${e}</div>\n\t\t\t\t\t<div><span>Alt</span> + <span>${t.toUpperCase()}</span></div>\n\t\t\t\t</div>`)).join(""),i=e=>" + "===e?"<span>+</span>":e.split("+").map((e=>e&&" "!==e?"<span>"+e+"</span>":"")).join(" + "),a=this.stx.container.closest("cq-context");if(!a)return void this.mo.disconnect();return`\n\t\t<div class="ciq-shortcut-container">\n\t\t\t<div>\n\t\t\t\t<div><b>Drawing tools shortcuts</b></div>\n\t\t\t\t<div>${t}</div>\n\t\t\t</div>\n\t\t\t<hr>\n\t\t\t<div>\n\t\t\t\t<div><b>Hotkeys</b></div>\n\t\t\t\t<div>${(e.hotkeyConfig&&e.hotkeyConfig.hotkeys||[]).map((({label:e,action:t,commands:r,extension:n})=>{return n&&(s=n,!a.hasAttribute(s.toLowerCase()+"-active"))?"":`<div class="ciq-shortcut"><div>${e||t}</div><div>${(e=>e.map((e=>e.replace(/Arrow|Key|Digit|^ | $/g,""))).map((e=>e.replace(/\+/," + "))).reduce(((e,t)=>{return!e.includes(t)&&(i=t).charCodeAt(i.length-1)<127?e.concat(t):e;var i}),[]).map(i).join("<br>"))(r)}</div></div>`;var s})).join("")}</div>\n\t\t\t</div>\n\t\t</div>\n\t`},t.Shortcuts.prototype.toggle=function(e){this.stx.dispatch("floatingWindow",{type:"shortcut",title:"Shortcuts",content:this.content,container:this.stx.uiContext.topNode,onClose:()=>this.closed=!0,width:this.width,status:e,tag:this.windowForEachChart?void 0:"shortcut"})}},c=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;function i(){}t.TableView=t.TableView||function({stx:e,minColumnWidth:a="84px",coverUIMaxWidth:r=400,coverContainer:n,usePreviousCloseForChange:s=!0}={}){e?(this.stx=e,this.viewAdditionalColumns=!1,this.minColumnWidth=a,this.coverUIMaxWidth=r,this.coverContainer=n,this.usePreviousCloseForChange=s,this.builder=i,this.listeners=[],e.tableView=this,this.cssRequired=!0,t.UI&&t.UI.observeProperty("uiContext",e,(({value:e})=>{e&&setTimeout((()=>{this.subscribeToChanges(e);const i=t.getFromNS(e.config,"hotkeyConfig.hotkeys",[]).find((({action:e})=>"tableView"===e));i&&(i.action=()=>{const{tableView:t}=e.topNode.ownerDocument.body.keystrokeHub.context.stx;if(t)return t.toggle(),!0})}))})),setTimeout((()=>{this.setup({minColumnWidth:a,coverUIMaxWidth:r,coverContainer:n})}))):console.warn("The TableView addon requires an stx parameter")},t.TableView.prototype.setup=function(e){const{stx:t}=this,i=this.builder.getChartCover(t,e),a=this.builder.createToolbar(t,e);i.append(a),i.style.display="none",t.addEventListener("symbolChange",(()=>{this.view&&(this.close(),this.builder.createTable(t,e),this.dialog.focus())})),this.dialog=i,this.toolbar={symbol:a.querySelector(".ciq-data-table-title"),copyBtn:a.querySelector(".ciq-data-table-copy"),downloadBtn:a.querySelector(".ciq-data-table-download"),additional:a.querySelector(".ciq-data-table-additionalColumns")}},t.TableView.prototype.open=function(e){e&&(this.params=e);const{config:i={},onClose:a}=this.params||{};if(this.view&&this.close(!1),this.onClose=a,this.builder.createTable(this.stx,i),!this.dialog)return;const{stx:r}=this,n=this.close.bind(this),s=this.dialog.ownerDocument.body.keystrokeHub;s&&s.addActiveModal(this),setTimeout((()=>this.removeCloseListener=function(e){const i=r.uiContext.topNode,a=i.ownerDocument.body,s=e=>e.closest(".ciq-data-table-container"),o=({target:e})=>!s(e)&&n();i.addEventListener("click",o);const l=e=>{const{tableView:i}=a.keystrokeHub.context.stx;if(i)if("Escape"===e.code)i.close(),e.preventDefault();else{if(!t.UI||!t.UI.BaseComponent)return;const r=t.UI.BaseComponent.prototype,n=i.view.querySelectorAll("button");if("Tab"===e.code){let{shiftKey:t}=e||{};r.focusNextItem(n,t,!0);const i=r.findFocused(n);i[0]&&r.highlightItem.call({keyboardNavigation:a.keystrokeHub},i[0])}else if("Enter"===e.code){const t=r.findFocused(n);t[0]&&r.clickItem(t[0],e)}}};a.addEventListener("keydown",l);const c=t.getFn("UI.getUIManager")(i);c&&(e.view.show=e.view.hide=function(){},c.openMenu(e.view,{}));return()=>{i.removeEventListener("click",o),a.removeEventListener("keydown",l),c&&c.closeMenu(e.view)}}(this)))},t.TableView.prototype.close=function(e=!0){let t;if(this.dialog.style.display="none",this.view&&(t=this.view.ownerDocument.body,this.view.remove(),this.view=null),e&&this.onClose&&this.onClose(),this.removeCloseListener&&(this.removeCloseListener(),this.removeCloseListener=null),t&&t.keystrokeHub){let{tabActiveModals:e}=t.keystrokeHub,i=e.indexOf(this);i>-1&&e.splice(i,1),t.keystrokeHub.highlightAlign()}},t.TableView.prototype.toggle=function(){this[this.view?"close":"open"](),this.view||this.dialog.focus()},t.TableView.prototype.subscribeToChanges=function(e,i="channels.tableView"){const{channelSubscribe:a,channelWrite:r}=t.UI.BaseComponent.prototype,{channels:{tableView:n=i}={}}=e.config||{},{stx:s}=this;a(n,(e=>{e?(s.tableView.open({onClose:()=>{r(n,!1,s)}}),s.tableView.dialog.focus()):s.tableView.close()}),s)},i.colHeaders={date:{label:"Date",alias:"DT"},open:{label:"Open"},high:{label:"High"},low:{label:"Low"},close:{label:"Close"},pctChange:{label:"% Change",cls:"ciq-extra"},pctChangeVsAvg:{label:"% Change vs Average",cls:"ciq-extra"},volume:{label:"Volume",cls:"ciq-extra"}},i.percentDecimalPlaces=2,i.createToolbar=function(e,t={}){const i=this,{symbolDisplay:a,symbol:r}=e.chart,{builder:n}=e.tableView,{dataToCsv:s,downloadCsv:o,getFilenameFormatter:l}=n,{fileNameFormatter:c=l(e)}=t,d=Object.assign({},this.colHeaders);return n.getCoverToolbar({symbol:a||r,viewAdditionalColumns:e.tableView.viewAdditionalColumns,copyFn:function(){const t=document.createElement("textArea");e.container.ownerDocument.body.appendChild(t),t.textContent=s(i.currentTable,{colHeaders:d,colSeparator:","}),t.select(),e.container.ownerDocument.execCommand("copy"),t.remove(),e.dispatch("notification","copytoclipboard")},downloadFn:function(){const t=s(i.currentTable,{colHeaders:d,colSeparator:","}),a=c(t);o(t,a,e)},toggleAdditionalColumnsFn:t=>{const{tableView:i}=e;i.viewAdditionalColumns=!i.viewAdditionalColumns,i.open()},closeFn:()=>e.tableView.close()})},i.createTable=function(e,i={}){if(!e.chart||!e.chart.dataSegment)return;const{tableView:a}=e,{builder:r}=a,{getChartData:n,dataToHtml:s,getDateFormatter:o,getValueFormatter:l,getVolumeFormatter:c,getSeriesDataNames:d,getStudyDataNames:h}=r,u=Object.assign({},this.colHeaders);if(e.chart.highLowBars||(delete u.open,delete u.high,delete u.low),!a.viewAdditionalColumns)for(let e in u)u[e].cls&&delete u[e];const m=Object.values(u).map((e=>e.label)),p=d(e);p.forEach((e=>u[e]={label:e}));const f=h(e);f.forEach((e=>{m.includes(e)||(u[e]={label:e})}));const y=p.concat(f),{dateFormatter:v=o(e),valueFormatter:g=l(e),percentFormatter:x=l(e,this.percentDecimalPlaces),volumeFormatter:b=c(e),minColumnWidth:C="84px"}=i,w=n(e,{dateFormatter:v,valueFormatter:g,percentFormatter:x,volumeFormatter:b,additionalDataFields:y});this.currentTable=w;const k=a.dialog;k.style.display="";const{symbolDisplay:S,symbol:T}=e.chart,D=`Symbol: ${S||T}`;return a.toolbar.symbol.innerText=D,a.toolbar.symbol.setAttribute("aria-label",D),setTimeout((()=>{const i=s(w,{colHeaders:u,minColumnWidth:C});k.appendChild(i),a.view=i;const r=t.getFromNS(e,"uiContext.config.scrollbarStyling");r&&(r.refresh(k.querySelector("tbody")),r.refresh(k.querySelector(".ciq-data-table-wrapper"),{suppressScrollY:!0})),e.translateUI&&e.translateUI(k),k.classList.remove("loading")})),k},i.dataToHtml=function(e,{colHeaders:t,minColumnWidth:i}){const a=Object.keys(t).length,r=`calc((100% - ${10+4*a}px ) / ${a})`,n=Object.entries(t).map((([,{label:e}],t)=>`<th\n\t\t\tscope="col"\n\t\t\tstyle="width: ${r};"\n\t\t\t>${e.replace("(","  (")}</th>`)),s=e.map((e=>`<tr>${Object.keys(t).map(((t,i)=>{const a=e[t];return 0===i?`<th scope="row"\n\t\t\t\t\t\t\tstyle="width: ${r}"\n\t\t\t\t\t\t>${a}</th>`:`<td style="width: ${r}">${a}</td>`})).join("")}</tr>`)),o=document.createElement("div");o.classList.add("ciq-data-table-wrapper");const l=i?`calc(${a} * ${i})`:"";return o.innerHTML=`\n\t\t<table class="header-fixed"\taria-description="Data visible in the chart"\n\t\t${l?`style="min-width: ${l}"`:""}>\n\t\t<thead role="rowgroup">${n.join("")}</thead>\n\t\t<tbody role="rowgroup">${s.join("")}</tbody>\n\t\t</table>`,o},i.dataToCsv=function(e,{colHeaders:t,colSeparator:i="\t"}){const a=Object.entries(t).map((([,{label:e}])=>`"${e}"`)).join(i),r=Object.entries(t).map((e=>e[1].alias||e[0]));return`${a}\n${e.map((e=>r.map((t=>`"${"DT"===t?e[t].toISOString():e[t]}"`)).join(i))).reverse().join("\n")}`},i.downloadCsv=function(e,t="filename",i=null){const a=new Blob([e],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");r.href=window.URL.createObjectURL(a,{type:"text/plain"}),r.download=`${t}.csv`,r.style.display="none";const n=((i||{}).container||{}).ownerDocument||document;n.body.appendChild(r),r.click(),n.body.removeChild(r)},i.getChartData=function(e,{dateFormatter:i,valueFormatter:a,percentFormatter:r,volumeFormatter:n,additionalDataFields:s}){const o=e.chart.dataSegment.filter((e=>null!==e)),{usePreviousCloseForChange:l}=e.tableView;let c=[],d=0;const h=o.reduce(((e,{Close:t,iqPrevClose:i,Open:a})=>{const r=l?i:a;return void 0===t||Number.isNaN(t)||void 0===r||Number.isNaN(r)?e:(d++,e+(t-r)/r)}),0)/d;return o.forEach(((o,d)=>{const{DT:u,displayDate:m,High:p,Low:f,Open:y,Close:v,iqPrevClose:g,Volume:x}=o,b=l?g:y,C=(v-b)/b,w=m||(e.displayZone?t.convertTimeZone(u,e.dataZone,e.displayZone):u),k={DT:u,date:i(w),open:a(y),close:a(v),change:a(v-b),pctChange:r(100*C),pctChangeVsAvg:r(100*(C-h)),high:a(p),low:a(f),volume:n(x)};s.forEach((e=>{let t=o[e];null!=t?("object"==typeof t&&(t=t.Close),k[e]=a(t)):k[e]=""})),c.push(k)})),c.sort(((e,t)=>t.DT-e.DT)),c},i.getDateFormatter=function(e){return(i,a)=>i?t.displayableDate(e,e.chart,i,!0):""},i.getValueFormatter=function(e,t){const{chart:{panel:i,yAxis:a},layout:{chartScale:r}}=e;let n;return n=a.originalPriceFormatter&&a.originalPriceFormatter.func?r=>a.originalPriceFormatter.func(e,i,r,t):a.priceFormatter&&"percent"!=r&&"relative"!=r?r=>a.priceFormatter(e,i,r,t):a=>e.formatYAxisPrice(a,i,t),e=>n(e).replace(/^-*0\.0*$/,"0")},i.getVolumeFormatter=function(e){return i=>{if(null==i)return"";if(e.internationalizer)return e.internationalizer.priceFormatters[0].format(i);const a=i.toString().split(".");return a[0]=t.commas(a[0]),a[0]}},i.getFilenameFormatter=function(e){return i=>{const a=e.chart.symbolDisplay||e.chart.symbol;let r,n;if(i){const e=i.split("\n");e.length>1&&([,r=""]=e[e.length-1].match(/^"([^"]*)"/)||[],[,n=""]=e[1].match(/^"([^"]*)"/)||[],r=t.yyyymmddhhmmssmmm(new Date(r)),n=t.yyyymmddhhmmssmmm(new Date(n)))}return`${a}${r?` (${r} _ ${n})`:""}`}},i.getChartCover=function(e,{coverUIMaxWidth:t,coverContainer:i}){const a=i&&e.container.ownerDocument.querySelector(i)||(e.uiContext&&e.container.offsetWidth<t?e.uiContext.topNode:e.container.parentElement.parentElement),r=document.createElement("div");Object.assign(r.style,{top:0,left:0,right:0,bottom:0}),r.classList.add("ciq-data-table-container","loading"),r.setAttribute("role","dialog"),r.setAttribute("aria-label","Data Table"),r.setAttribute("tabindex",0);const n=document.createElement("div");return n.classList.add("ciq-spinner-wrapper"),n.innerHTML='<span class="ciq-spinner"></span>',r.appendChild(n),a.appendChild(r),r},i.getCoverToolbar=function({symbol:e,viewAdditionalColumns:t,copyFn:i,downloadFn:a,toggleAdditionalColumnsFn:r,closeFn:n}){const s=document.createElement("div");s.classList.add("ciq-data-table-toolbar"),s.innerHTML=`\n\t\t<div class="ciq-data-table-title"></div>\n\t\t<button class="ciq-data-table-copy">${this.copyLabel}</button>\n\t\t<button class="ciq-data-table-download">${this.downloadLabel}</button>\n\t\t<div>\n\t\t\t<label>\n\t\t\t\t<input\n\t\t\t\t\ttype="checkbox"\n\t\t\t\t\trole="switch"\n\t\t\t\t\tname="additionalColumns"\n\t\t\t\t\tclass="ciq-data-table-additionalColumns"\n\t\t\t\t/><span>Show Additional Columns</span>\n\t\t\t</label>\n\t\t</div>\n\t\t<cq-close role="button" aria-label="close" />\n\t`;const o=s.querySelector(".ciq-data-table-title");o.textContent=e,o.setAttribute("aria-label",e),o.setAttribute("role","heading");const l=s.querySelector(".ciq-data-table-copy");i?l.addEventListener("click",i):l.style.display="none";const c=s.querySelector(".ciq-data-table-download");a?c.addEventListener("click",(function(){c.blur(),a()})):c.style.display="none";const d=s.querySelector(".ciq-data-table-additionalColumns");return r?d.addEventListener("click",r):d.style.display="none",s.close=n,s},i.copyLabel="Copy",i.downloadLabel="Download",i.getAdditionalColumnLabel=function(e){return`<span>${e?"- ":"+ "}</span>Additional columns`},i.getStudyDataNames=function(e){return Object.values(e.layout.studies||{}).filter((e=>!e.signalData||e.signalData.reveal)).map((function(e){return Object.keys(e.outputMap).filter(t)})).reduce(((e,t)=>e.concat(t)),[]);function t(t){return e.chart.dataSegment.some((e=>e&&e[t]))}},i.getSeriesDataNames=function(e){return Object.values(e.chart.seriesRenderers||{}).filter((e=>"_main_series"!==e.params.name)).map((e=>e.seriesParams.map((({symbol:e})=>e)))).reduce(((e,t)=>e.concat(t)),[])}},d=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.Marker?t.Tooltip=t.Tooltip||function(e){if(!t.Marker)return void console.warn("CIQ.Tooltip addon requires CIQ.Marker module to be enabled.");this.cssRequired=!0;const{stx:i,ohl:a,change:r,volume:n,series:s,studies:o,signalStudies:l,interpolation:c,showOverBarOnly:d,showBarHighlight:h=!0,useDataZone:u}=e,{container:m}=i.chart;let p=m.querySelector("stx-hu-tooltip");p||(p=document.createElement("stx-hu-tooltip"),m.appendChild(p));let f=m.querySelector(".stx-hu-tooltip-highlight");function y(){const{headsUp:e,crosshair:t}=i.layout,a=e&&e.floating||"floating"===e,r=t&&i.displayCrosshairs&&["static",null,void 0].includes(e);return!(!i.huTooltip||a||r)&&(v(),!0)}function v(){const{huTooltip:e}=i,{node:t}=e;t&&(t.style.left="-50000px",t.style.right="auto",e.lastBar={},e.highlightEl&&(e.highlightEl.style.display="none"))}function g(){var e=this;if(!y()){var i=e.barFromPixel(e.cx),d=e.chart.dataSegment[i];if(d){if(!t.Marker.Tooltip.sameBar(d,e.huTooltip.lastBar)||i==e.chart.dataSegment.length-1){var h=e.huTooltip.node;Array.from(h.parentElement.querySelectorAll("[auto]")).forEach((function(e){e.remove()})),Array.from(h.parentElement.querySelectorAll("stx-hu-tooltip-field-value")).forEach((function(e){e.innerHTML=""}));var m=e.chart.panel,p=m.yAxis,f={},g=[];if(g.push({member:"DT",display:"DT",panel:m,yAxis:p}),g.push({member:"Close",display:"Close",panel:m,yAxis:p}),f.DT=f.Close=1,r&&t.ChartEngine.isDailyInterval(e.layout.interval)&&g.push({member:"Change",display:"Change",panel:m,yAxis:p}),a&&(g.push({member:"Open",display:"Open",panel:m,yAxis:p}),g.push({member:"High",display:"High",panel:m,yAxis:p}),g.push({member:"Low",display:"Low",panel:m,yAxis:p}),f.Open=f.High=f.Low=1),n&&(g.push({member:"Volume",display:"Volume",panel:null,yAxis:null}),f.Volume=1),s){var x=e.chart.seriesRenderers;for(var b in x){var C=x[b];if(C!==e.mainSeriesRenderer){m=e.panels[C.params.panel],!(p=C.params.yAxis)&&C.params.shareYAxis&&(p=m.yAxis);for(var w=0;w<C.seriesParams.length;w++){var k=C.seriesParams[w],S=k.symbol,T=k.field;S?T&&S!=T&&(S=t.createObjectChainNames(S,T)[0]):S=T;var D=k.display||k.symbol||k.field;S&&!f[D]&&(g.push({member:S,display:D,panel:m,yAxis:p,isSeries:!0}),f[D]=1)}}}}if(o||l)for(var L in e.layout.studies){var F=e.layout.studies[L];if(l||!F.signalData||F.signalData.reveal){for(var E in p=(m=e.panels[F.panel])&&F.getYAxis(e),e.layout.studies[L].outputMap)E&&!f[E]&&(g.push({member:E,display:E,panel:m,yAxis:p}),f[E]=1);f[L+"_hist"]||(g.push({member:L+"_hist",display:L+"_hist",panel:m,yAxis:p}),g.push({member:L+"_hist1",display:L+"_hist1",panel:m,yAxis:p}),g.push({member:L+"_hist2",display:L+"_hist2",panel:m,yAxis:p}),f[L+"_hist"]=1)}}for(var A=0;A<g.length;A++){var q=g[A],M=q.member,P=q.display,H="DT"==M;!H||u||t.ChartEngine.isDailyInterval(e.layout.interval)||(M="displayDate"),m=q.panel;var I=null;(p=q.yAxis)&&(m&&m===m.chart.panel?(I=Math.max(p.printDecimalPlaces,m.chart.decimalPlaces),(p.maxDecimalPlaces||0===p.maxDecimalPlaces)&&(I=Math.min(I,p.maxDecimalPlaces))):p.decimalPlaces||0===p.decimalPlaces?I=p.decimalPlaces:(p.maxDecimalPlaces||0===p.maxDecimalPlaces)&&(I=p.maxDecimalPlaces));var O=null,R=t.existsInObjectChain(d,M);R?O=R.obj[R.member]:"Change"==M&&(O=d.Close-d.iqPrevClose);var V=P.replace(/^(Result )(.*)/,"$2");if(c&&g[A].isSeries&&null==O){var _=e.valueFromInterpolation(i,V,"Close",m,p);if(null===_)break;O=_}if(!O&&0!==O||!H&&"object"==typeof O&&!O.Close&&0!==O.Close){var Q=h.querySelector('stx-hu-tooltip-field[field="'+V+'"]');if(Q)""!==Q.querySelector("stx-hu-tooltip-field-name").innerHTML&&(Q.querySelector("stx-hu-tooltip-field-value").innerHTML="n/a")}else{var j="";if((O.Close||0===O.Close)&&(O=O.Close),O.constructor==Number)if(p)j=p.originalPriceFormatter&&p.originalPriceFormatter.func?p.originalPriceFormatter.func(e,m,O,I):p.priceFormatter&&p.priceFormatter!=t.Comparison.priceFormat?p.priceFormatter(e,m,O,I):e.formatYAxisPrice(O,m,I,p);else{j=O;var B=e.internationalizer;if(B){var z=B.priceFormatters.length,U=t.countDecimals(j);U>=z&&(U=z-1),j=B.priceFormatters[U].format(j)}}else O.constructor==Date?H&&e.controls.floatDate&&e.controls.floatDate.innerHTML?j=e.chart.xAxis.noDraw?"N/A":t.displayableDate(e,m.chart,O):(j=t.yyyymmdd(O),t.ChartEngine.isDailyInterval(e.layout.interval)||(j+=" "+O.toTimeString().substr(0,8))):j=O;var W=h.querySelector('stx-hu-tooltip-field[field="'+V+'"]');if(W){W.querySelector("stx-hu-tooltip-field-value").innerHTML=j;var N=W.querySelector("stx-hu-tooltip-field-name");""===N.innerHTML&&(N.innerHTML=V,e.translateUI&&e.translateUI(N))}else{var $=document.createElement("stx-hu-tooltip-field");$.setAttribute("auto",!0);var Y=document.createElement("stx-hu-tooltip-field-name");Y.innerHTML=e.translateIf(V),$.appendChild(Y);var Z=document.createElement("stx-hu-tooltip-field-value");Z.innerHTML=j,$.appendChild(Z),h.appendChild($)}}}e.huTooltip.render()}}else v()}}function x(e){if("-50000px"!==e.node.style.left){var a=i.controls.mSticky;if(a&&"none"!==a.style.display){var r=t.stripPX(e.node.style.top)-t.elementDimensions(a,{padding:!0,border:!0,margin:!0}).height;r<0&&(e.node.style.top=t.stripPX(e.node.style.top)-r+"px",r=0);var n=a.style;t.efficientDOMUpdate(n,"top",r+"px"),t.efficientDOMUpdate(n,"left",e.node.style.left),t.efficientDOMUpdate(n,"right",e.node.style.right)}}}f||(f=document.createElement("div"),f.classList.add("stx-hu-tooltip-highlight"),m.appendChild(f)),t.Marker.Tooltip=function(e){this.className||(this.className="CIQ.Marker.Tooltip"),this.highlightEl=f,e.label="tooltip",t.Marker.call(this,e)},t.inheritsFrom(t.Marker.Tooltip,t.Marker,!1),t.Marker.Tooltip.sameBar=function(e,t){return!(!e||!t)&&(+e.DT==+t.DT&&(e.Close==t.Close&&(e.Open==t.Open&&e.Volume==t.Volume)))},t.Marker.Tooltip.placementFunction=function(e){if(!y()){for(var i=e.stx,a=0;a<e.arr.length;a++){var r,n,s,o=e.arr[a],l=i.barFromPixel(i.cx),c=i.chart.dataSegment[l],u=!0;if("undefined"!=c&&c&&c.DT&&(r=!0,c.High&&(n=i.pixelFromPrice(c.High)),c.Low&&(s=i.pixelFromPrice(c.Low)),i.chart.highLowBars||c.Close&&(n=i.pixelFromPrice(c.Close)-15,s=i.pixelFromPrice(c.Close)+15),!d||i.cy>=n&&i.cy<=s||(u=!1)),!i.insideChart||i.openDialog||i.activeDrawing||i.grabbingScreen||!r||!u)return f.style.display="none",o.node.style.left="-50000px",o.node.style.right="auto",void(o.lastBar={});if(t.Marker.Tooltip.sameBar(i.chart.dataSegment[l],o.lastBar)&&l!=i.chart.dataSegment.length-1)return void x(o);o.lastBar=i.chart.dataSegment[l];var p=o.lastBar.candleWidth||i.layout.candleWidth;parseInt(getComputedStyle(o.node).width,10)+i.chart.panel.left+30+p<i.backOutX(t.ChartEngine.crosshairX)?(o.node.style.left="auto",o.node.style.right=Math.round(m.clientWidth-i.pixelFromBar(l)+30)+"px"):(o.node.style.left=Math.round(i.pixelFromBar(l)+30)+"px",o.node.style.right="auto");var v=parseInt(getComputedStyle(o.node).height,10),g=Math.round(i.backOutY(t.ChartEngine.crosshairY)-v/2);if(g+v>i.height&&(g=i.height-v),g<0&&(g=0),o.node.style.top=g+"px",x(o),h&&!i.layout.crosshair){const e=o.lastBar.candleWidth||i.layout.candleWidth,t=i.pixelFromBar(l)-e/2;let a=e;t+a>i.chart.width&&(a=i.chart.width-t),f.style.display="block",f.style.left=t+"px",f.style.width=a+"px"}else f.style.display="none"}if(t.touchDevice&&i.layout.crosshair){var b=i.overXAxis,C=i.overYAxis;i.overXAxis=i.overYAxis=!1,i.doDisplayCrosshairs(),i.overXAxis=b,i.overYAxis=C}}},m.addEventListener("mouseout",v),i.append("mousemoveinner",(function(){x(this.huTooltip)})),i.append("deleteHighlighted",(function(){this.huTooltip.lastBar={},this.headsUpHR()})),i.append("headsUpHR",g),i.append("createDataSegment",g),i.huTooltip=new t.Marker.Tooltip({stx:i,xPositioner:"bar",chartContainer:!0,node:p})}:console.error("tooltip addon requires first activating markers feature.")},h=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.Animation=t.Animation||function(e){if(!e)throw new Error("Invalid constructor arguments.");var i,a,r;if(e instanceof t.ChartEngine?(i=arguments[0],a=arguments[1],r=arguments[2]):(i=e.stx,a=e.animationParameters,r=e.easeMachine),!i)return console.warn("No CIQ.ChartEngine provided. Cannot properly create CIQ.Animation instance");this.cssRequired=!0;var n={stayPut:!1,ticksFromEdgeOfScreen:5,granularity:1e6};a=t.extend(n,a),n.tension&&(i.chart.tension=a.tension),i.tickAnimator=r||new t.EaseMachine("easeOutCubic",1e3);var s=new t.EaseMachine("easeInOutCubic",1e3),o=["#0298d3","#19bcfc","#5dcffc","#9ee3ff"],l=0,c=20,d=0,h=!1,u=null;function m(){h=!1,u=null}t.UI&&t.UI.observeProperty("animation",i.layout,(({value:e})=>{n.tension&&(i.chart.tension=e?a.tension:0)})),i.addEventListener(["symbolChange","layout"],(function(e){m()})),i.prepend("updateCurrentMarketData",(function(e,t,i,a){t||(t=this.chart),a&&a.fromTrade&&t.closePendingAnimation&&(a.finalClose=t.closePendingAnimation.Close)})),i.prepend("updateChartData",(function(e,i,r){var n=this;if(i||(i=n.chart),i&&i.defaultChartStyleConfig&&"none"!=i.defaultChartStyleConfig&&this.layout.animation&&(void 0===r||!r.animationEntry&&!r.secondarySeries)&&i.dataSegment){var s=n.tickAnimator,o=this.mainSeriesRenderer&&this.mainSeriesRenderer.supportsAnimation;if(o){if(!s)return void console.warn("Animation plug-in can not run because the tickAnimator has not been declared. See instructions in animation.js");if(this.prevSymbol!=i.symbol&&(this.prevQuote=0,i.closePendingAnimation=null,this.prevSymbol=i.symbol),L(),s.stop(),e.length>1){var l=e.splice(0,e.length-1),c=t.clone(r);c.animationEntry=!0,c.bypassGovernor=!0,c.noCreateDataSet=!1,c.appending=!0,n.updateChartData(l,i,c)}}var d=t.clone(r);d||(d={}),d.animationEntry=!0,d.bypassGovernor=!0,d.noCreateDataSet=!1,d.appending=!0,d.firstLoop=!0;var m=this.chart.symbol,p=this.layout.periodicity,f=this.layout.interval,y=this.layout.timeUnit;if(o){var v=e[e.length-1];this.prevQuote=this.currentQuote("Close");var g=!1,x=!1;if(n.isHome()||(x=!0),!(v&&v.Close&&this.prevQuote&&this.prevQuote.Close))return!1;if(this.extendedHours&&i.market.market_def){var b=v.DT;if(t.ChartEngine.isDailyInterval(f))h=!i.market.isMarketDate(b);else if(!u||u<=b){var C=i.market.getSession(b);h=!(""===C||this.layout.marketSessions&&this.layout.marketSessions[C]),u=i.market[h?"getNextOpen":"getNextClose"](b)}if(h)return this.draw(),!1}var w=p;"second"==f||"second"==y?w*=1e3:"minute"!=f&&"minute"!=y||(w*=6e4),isNaN(f)||(w*=f),g="day"==f||"day"==y?v.DT.getDate()!=this.prevQuote.DT.getDate():"week"==f||"week"==y?v.DT.getDate()>=this.prevQuote.DT.getDate()+7:"month"==f||"month"==y?v.DT.getMonth()!=this.prevQuote.DT.getMonth():v.DT.getTime()>=this.prevQuote.DT.getTime()+w;var k=!this.mainSeriesRenderer||!this.mainSeriesRenderer.standaloneBars,S=0;if(g){if(!this.animations.zoom.hasCompleted)return!1;var T=this.layout.candleWidth;if(i.scroll<=i.maxTicks)for(;this.micropixels>0;)i.scroll++,this.micropixels-=T;S=-1*T,i.scroll<=i.maxTicks?(this.previousMicroPixels=this.micropixels,this.nextMicroPixels=this.micropixels+T,i.dataSegment.length<i.maxTicks-a.ticksFromEdgeOfScreen&&!a.stayPut&&(this.nextMicroPixels=this.micropixels,i.scroll>=i.maxTicks-this.preferences.whitespace/this.layout.candleWidth&&i.scroll++),i.animatingHorizontalScroll=k,i.previousDataSetLength=i.dataSet.length):x||i.scroll++}i.closePendingAnimation={Close:v.Close,Open:v.Open,High:v.High,Low:v.Low};var D=g&&!k?v.Open:this.prevQuote.Close;return s.run(function(e,r,o){return function(l){var c=l.Close;if(!i.dataSet.length||m!=i.symbol||p!=n.layout.periodicity||f!=n.layout.interval||y!=n.layout.timeUnit)return s.stop(),void L();var h=t.clone(e);h.Adj_Close=null,h.Close=Math.round(c*a.granularity)/a.granularity,i.animatingHorizontalScroll&&(n.micropixels=l.micropixels,i.lastTickOffset=l.lineOffset),d.updateDataSegmentInPlace=!s.hasCompleted;var u=[h];o&&"tick"!==n.layout.interval&&u.unshift(r),n.updateChartData(u,i,d),d.firstLoop=!1,s.hasCompleted&&L()}}(v,t.clone(this.prevQuote),g),{Close:D,micropixels:this.nextMicroPixels,lineOffset:S},{Close:v.Close,micropixels:this.micropixels,lineOffset:0}),!0}}function L(){i.animatingHorizontalScroll&&(i.animatingHorizontalScroll=!1,n.micropixels=n.nextMicroPixels=n.previousMicroPixels,i.lastTickOffset=0),i.closePendingAnimation&&(!function(e){if(i.masterData)for(var t=i.masterData.length-1;t>=0;t--){var a=i.masterData[t];if(a.Close||0===a.Close)return a.Close=e.Close,e.LastSize&&(a.LastSize=e.LastSize),e.LastTime&&(a.LastTime=e.LastTime),void 0===e.Open&&void 0!==a.Open&&(a.Open=e.Close),void 0===e.High&&void 0!==a.High&&(a.High=e.Close),void 0===e.Low&&void 0!==a.Low&&(a.Low=e.Close),n.updateCurrentMarketData({Close:a.Close,DT:a.DT,LastSize:a.LastSize,LastTime:a.LastTime},null,null,{animationLastBar:!0,fromTrade:!0}),void n.createDataSet(null,null,{appending:!0})}}(i.closePendingAnimation),i.closePendingAnimation=null)}})),i.prepend("renderYAxis",(function(e){if(!this.grabbingScreen&&this.isHome()&&this.layout.animation&&(this.mainSeriesRenderer&&this.mainSeriesRenderer.supportsAnimation)){var i=e.panel.yAxis;if(!t.Comparison||i.priceFormatter!=t.Comparison.priceFormat)if(e.prevLowValue||0===e.prevLowValue||(e.prevLowValue=e.animatedLow=e.lowValue),e.prevHighValue||0===e.prevHighValue||(e.prevHighValue=e.animatedHigh=e.highValue),s.running||(e.animatingVerticalScroll=!1),e.prevLowValue>=e.lowValue&&e.prevHighValue<=e.highValue)e.animatingVerticalScroll&&(i.highValue=e.animatedHigh,i.lowValue=e.animatedLow);else if(s.running&&s.stop(),e.lowValue||e.highValue){var a=e.prevLowValue,r=e.prevHighValue;e.prevLowValue=e.lowValue,e.prevHighValue=e.highValue,e.animatingVerticalScroll=!0,s.run(function(t){return function(i){e.animatedLow=i.low,e.animatedHigh=i.high,t.draw()}}(this),{low:a,high:r},{low:e.lowValue,high:e.highValue}),i.lowValue=e.animatedLow,i.highValue=e.animatedHigh}}})),i.append("draw",(function(){if(!h&&this.chart.dataSet&&this.chart.dataSet.length&&this.mainSeriesRenderer&&this.mainSeriesRenderer.supportsAnimation&&this.layout.animation){d%c==0&&(l++,d=0),d++;var e=this.chart.context,t=this.chart.panel,i=this.currentQuote("Close");if(!i)return;var a=i.Close,r=this.pixelFromTick(i.tick,this.chart);this.chart.lastTickOffset&&(r+=this.chart.lastTickOffset);var n=this.pixelFromPrice(a,t);this.chart.yAxis.left>r&&this.chart.yAxis.top<=n&&this.chart.yAxis.bottom>=n&&(l>=o.length&&(l=0),e.beginPath(),e.moveTo(r,n),e.arc(r,n,2+1.07*l,0,2*Math.PI,!1),e.fillStyle=o[l],e.fill())}}))}},u=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.ContinuousZoom=t.ContinuousZoom||function(e){this.cssRequired=!0,this.update(e),this.stx.continuousZoom=this,this.addSmartZoomButton=function(){var e=this.stx.registerChartControl&&this.stx.registerChartControl("stx-smart-zoom","SmartZoom (Alt + 0)",function(e){return function(t){e.smartZoomToggle(t),t.stopPropagation()}}(this));e&&(this.stx.addEventListener("layout",(function(t){!0===t.stx.layout.smartzoom?e.classList.add("active"):e.classList.remove("active")})),this.stx.addEventListener("symbolImport",(function(t){!1===t.stx.layout.smartzoom&&e.classList.remove("active")})))},this.smartZoomToggle=function(e){this.smartZoomEnable(!this.stx.layout.smartzoom)},this.smartZoomEnable=function(e){this.stx.layout.smartzoom=e,this.stx.changeOccurred("layout")},this.addSmartZoomButton(),this.smartZoomEnable(!0)},t.ContinuousZoom.prototype.update=function(e){e||(e={}),this.stx=e.stx,this.periodicities=e.periodicities,this.boundaries=e.boundaries},t.ContinuousZoom.prototype.execute=function(e){function t(e){var t=e.period||e.periodicity,i=e.interval,a=e.timeUnit||"minute";switch(isNaN(i)&&(a=i,i=1),a){case"month":i*=4.35;case"week":i*=7;case"day":i*=1440;case"minute":i*=60;case"second":break;case"millisecond":i/=1e3;break;default:return null}return t*i}if(this.stx&&this.stx.layout.smartzoom){var i=this.periodicities,a=this.boundaries,r=this.stx,n=r.layout,s=r.chart;if(i&&a&&(!e&&a.maxCandleWidth&&n.candleWidth>a.maxCandleWidth||e&&a.minCandleWidth&&n.candleWidth<a.minCandleWidth||!e&&a.minTicks&&s.maxTicks<a.minTicks||e&&a.maxTicks&&s.maxTicks>a.maxTicks)){for(var o={value:e?Number.MAX_VALUE:0},l=t(n),c=0;c<i.length;c++){var d=t(i[c]);(d>l&&d<o.value&&e||d<l&&d>o.value&&!e)&&(o={value:d,periodicity:i[c]})}var h=o.periodicity;h&&r.setRange({dtLeft:s.xaxis[0].DT,dtRight:s.xaxis[s.xaxis.length-1].DT,dontSaveRangeToLayout:!0,periodicity:h,padding:r.preferences.whitespace})}}}},m=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.Outliers=t.Outliers||function(e){if(e||(e={}),e.stx){Array.isArray(e.altColors)||(e.altColors=["#323390","#66308f","#0073ba","#f4932f","#0056a4","#00a99c","#00a553","#ea1d2c","#e9088c","#fff126","#912a8e","#ee652e","#00afed","#8ec648"]),this.stx=e.stx,this.stx.outliers=this,this.cssRequired=!0,this.multiplier=e.multiplier||3,this.altColors=e.altColors,this.axisData={},this.stx.addEventListener("layout",(function(e){Object.keys(e.stx.outliers.axisData).forEach(function(e){this.removeAllMarkers(this.axisData[e]),delete this.axisData[e]}.bind(e.stx.outliers))})),t.UI&&t.UI.KeystrokeHub.addHotKeyHandler("outliers",(({stx:e})=>{e.container.ownerDocument.body.keystrokeHub.context.advertised.Layout.setOutliers()}),this.stx),this.processDataSet=function(e,t,i){if(!e.length||e.length<=1)return!1;var a=[0,0];if(!this.axisData[i.name]){var r="",n=-1;Object.keys(this.axisData).forEach(function(e){this.axisData[e].panel.name==t.name&&n++}.bind(this)),n>-1&&n<this.altColors.length&&(r=this.altColors[n]),this.axisData[i.name]={axis:i,panel:t,displayState:"none",isFlipped:!1,originalZoom:i.zoom,markerColor:r,markers:{},axisMarkers:{}}}var s=this.axisData[i.name];return Object.assign(s,this.find(e)),this.refreshMarkerArray(s),this.refreshMarkers(s),"low"!==s.displayState&&"all"!==s.displayState||null===s.outlierMin?a[0]=s.trendMin:a[0]=s.outlierMin,"high"!==s.displayState&&"all"!==s.displayState||null===s.outlierMax?a[1]=s.trendMax:a[1]=s.outlierMax,a},this.find=function(e){if(e.length&&!(e.length<=0)){var t,i,a=function(e,t){return{quote:e.quote,DT:e.quote.DT,value:e.value,position:t}},r=null,n=null,s=null,o=null,l=[],c=e.slice();c.sort((function(e,t){return e.value-t.value}));var d=c.length,h=c[Math.floor(d/4)].value,u=c[Math.floor(d*(3/4))].value,m=u-h;t=h-m*this.multiplier,i=u+m*this.multiplier;for(var p=0;p<d;p++){var f=c[p],y=c[d-(p+1)];if(f.value<=t&&l.push(a(f,"low")),y.value>=i&&l.push(a(y,"high")),null===s&&f.value<=t&&(s=f.value),null===o&&y.value>=i&&(o=y.value),null===r&&f.value>t&&(r=f.value),null===n&&y.value<i&&(n=y.value),null!==r&&null!==n)break}return{minValue:t,maxValue:i,trendMin:r,trendMax:n,outlierMin:s,outlierMax:o,activeOutliers:l}}},this.refreshMarkerArray=function(e){this.deprecateMarkers(e);var t=e.markers;e.activeOutliers.forEach(function(i){var a=i.DT.getTime().toString();t[a]||(t[a]={isFresh:!0,type:"quote",value:i.value,marker:this.markOutlier(i,i.position,e)}),t[a].isFresh=!0}.bind(this)),null!==e.outlierMax&&(t.axisHigh||(t.axisHigh={isFresh:!0,type:"axis",value:e.outlierMax,marker:this.markAxis("high",e)}),t.axisHigh.isFresh=!0),null!==e.outlierMin&&(t.axisLow||(t.axisLow={isFresh:!0,type:"axis",value:e.outlierMin,marker:this.markAxis("low",e)}),t.axisLow.isFresh=!0)},this.setDisplayState=function(e,t){"high"!=e&&"low"!=e&&"all"!=e&&(e="none");var i=e;"all"==t.displayState&&"high"==e?i="low":"all"==t.displayState&&"low"==e?i="high":"high"==t.displayState&&"low"==e||"low"==t.displayState&&"high"==e?i="all":t.displayState==e&&(i="none"),t.displayState=i,t.axis.zoom=t.originalZoom,this.refreshMarkers(t),this.stx.draw()},this.deprecateMarkers=function(e){Object.keys(e.markers).forEach(function(e){var t;(t=this.markers[e]).marker&&!t.isFresh?(t.marker.remove&&t.marker.remove(),t.marker=null):t.isFresh=!1,this.markers[e].marker||delete this.markers[e]}.bind(e))},this.removeAllMarkers=function(e){Object.keys(e.markers).forEach((function(t){var i=e.markers[t].marker;i&&(i.remove&&i.remove(),i=null),i||delete e.markers[t]}))},this.updateMarkerVisibility=function(){Object.keys(this.markers).forEach(function(e){"all"==this.displayState||this.markers[e].marker.node.classList.contains(this.displayState)?this.markers[e].marker.node.style.display="none":this.markers[e].marker.node.style.display="block"}.bind(this))},this.refreshAxisMarkers=function(e,t){var i=!1;e.classList.contains("high")&&(i=!0);var a=t.axis.top;(!t.isFlipped&&!i||t.isFlipped&&i)&&(a=t.axis.bottom-50),e.classList.contains("nano")&&(a=t.axis.top+t.axis.height/2-22);var r=Math.floor(t.axis.left).toString()+"px",n=Math.floor(a).toString()+"px",s=i?t.outlierMax:t.outlierMin;e.style.transform="translate("+r+", "+n+")",e.querySelector(".outlier-value").innerText=this.stx.formatYAxisPrice(s),"0px"===r?e.classList.add("right"):e.classList.remove("right")},this.refreshMarkers=function(e){Object.keys(e.markers).forEach(function(e,t){var i=e.markers[t].marker,a=e.markers[t].value,r=e.markers[t].type;a>e.trendMax&&e.axis.high>=a||a<e.trendMin&&e.axis.low<=a?"quote"==r?i.node.style.display="none":"axis"==r&&i.node.classList.add("compress"):"quote"==r?i.node.style.display="block":"axis"==r&&i.node.classList.remove("compress"),"axis"==r&&this.refreshAxisMarkers(i.node,e),e.axis.height<100?i.node.classList.add("nano"):i.node.classList.remove("nano"),e.axis.height<250?i.node.classList.add("micro"):i.node.classList.remove("micro")}.bind(this,e)),e.isFlipped!==e.axis.flipped&&this.flipMarkers(e)},this.markAxis=function(e,i){var a=document.createElement("div");a.classList.add("outlier-sticker","axis","mini",e),a.innerHTML='<div class="expansion"><div class="pill"><div class="icon"></div></div><div class="tick"></div><span class="outlier-value"></div><div class="compression"><div class="pill"><div class="icon"></div></div></div></span>',this.matchYAxisStyle(a),this.setMarkerColor(a,i.markerColor);var r=this.handleMarkerClick.bind(this,e,i,a);return a.addEventListener("click",r),a.addEventListener("touchend",r),new t.Marker({stx:this.stx,xPositioner:"none",yPositioner:"none",label:"expand",permanent:!0,chartContainer:!0,node:a})},this.markOutlier=function(e,i,a){if(e){a||(a={panel:this.stx.panels.chart}),i=i||"high";var r=document.createElement("div");r.classList.add("outlier-sticker","quote","mini",i),r.innerHTML='<div class="pill"><div class="icon"></div></div><span class="outlier-value">'+this.stx.formatYAxisPrice(e.value,a.panel)+"</span>",this.matchYAxisStyle(r),this.setMarkerColor(r,a.markerColor);var n=this.handleMarkerClick.bind(this,i,a,r);return r.addEventListener("click",n),r.addEventListener("touchend",n),new t.Marker({stx:this.stx,xPositioner:"date",yPositioner:"high"==i?"top":"bottom",x:e.quote.DT,panelName:a.panel.name,node:r})}},this.handleMarkerClick=function(e,t,i){i.classList.contains("nano")&&(e="all"),this.setDisplayState(e,t),this.stx.draw()},this.matchYAxisStyle=function(e){if(this.stx.styles.stx_yaxis){var t=this.stx.styles.stx_yaxis;e.style.fontSize=t.fontSize,e.style.fontFamily=t.fontFamily,e.style.color=t.color,e.style.borderColor=t.color}},this.setMarkerColor=function(e,t){if(""!=t)for(var i=e.querySelectorAll(".pill"),a=0;a<i.length;a++)i[a].style.backgroundColor=t},this.flipMarkers=function(e){e.isFlipped=e.axis.flipped,Object.keys(e.markers).forEach(function(e,t){var i=e.markers[t].marker,a=e.markers[t].value,r=e.markers[t].type;e.isFlipped?i.node.classList.add("flipped"):i.node.classList.remove("flipped"),"quote"==r&&(a>e.trendMax?e.isFlipped?i.params.yPositioner="bottom":i.params.yPositioner="top":a<e.trendMin&&(e.isFlipped?i.params.yPositioner="top":i.params.yPositioner="bottom"))}.bind(this,e))};var i=t.ChartEngine.prototype.determineMinMax.bind(this.stx);t.ChartEngine.prototype.determineMinMax=function(e,t,a,r,n,s,o,l,c){return c||(c=[]),o&&l&&this.layout.outliers&&c.push(this.outliers.processDataSet.bind(this.outliers)),i(e,t,a,r,n,s,o,l,c)}}else console.warn("The Outliers addon requires an stx parameter")}},p=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.PlotComplementer=t.PlotComplementer||function(e){var i=e.stx,a=t.uniqueID();e.decorator||(e.decorator={});var r=e.decorator.symbol||"_"+a,n=e.decorator.display||" (addl)";i.plotComplementers||(i.plotComplementers=[]),i.plotComplementers.push(this),this.id=e.id||a,this.defaultRenderingParameters={chartType:"line",width:1,opacity:.5},e.renderingParameters&&(this.defaultRenderingParameters=e.renderingParameters);var s=this;function o(i,a,o,l){if("err"!=function(t){if(t.quoteDriver&&e.quoteFeed){for(var i=0;i<t.quoteDriver.quoteFeeds.length;i++)if(t.quoteDriver.quoteFeeds[i].engine==e.quoteFeed)return;return"err"}}(i)&&(l||(l=a),!i.isEquationChart(a)&&(o||(o={}),!o.isComparison&&l&&-1==l.indexOf(r)))){var c=l+r,d=a+r,h=i.getRendererFromSeries(l),u=t.extend({display:a+n,name:c,symbol:d,symbolObject:{symbol:d,generator:s.id,masterSymbol:a},overChart:!1,gapDisplayStyle:!0,permanent:!0,panel:o.panel,yAxis:o.yAxis,shareYAxis:!0,loadData:!!s.quoteFeed,dependentOf:h?h.params.name:i.mainSeriesRenderer.params.name},s.renderingParameters);u.color||(u.color=o.color||"auto"),i.addSeries(c,u,(function(e,t){e&&i.removeSeries(c,i.chart),i.chart.seriesRenderers[c]&&(i.chart.seriesRenderers[c].params.display=u.display)}))}}function l(e,t,i){t&&-1==t.indexOf(r)&&e.removeSeries(t+r,i)}function c(e){"master"==e.action?(e.prevSymbol||(e.prevSymbol=e.symbol),l(e.stx,e.prevSymbol,e.stx.chart),o(e.stx,e.symbol)):"add-series"==e.action?(l(e.stx,e.id,e.stx.chart),o(e.stx,e.symbol,e.parameters,e.id)):"remove-series"==e.action&&l(e.stx,e.id,e.stx.chart)}i.addEventListener("symbolChange",c),i.addEventListener("symbolImport",c),this.resetRenderingParameters=function(){this.renderingParameters=this.defaultRenderingParameters},this.setQuoteFeed=function(e){if(e.quoteFeed&&e.behavior){var a=t.clone(e.behavior);a.generator=this.id;var r=e.filter;i.attachQuoteFeed(e.quoteFeed,a,(function(e){return!(r&&!r(e))&&e.symbolObject.generator==a.generator})),this.quoteFeed=e.quoteFeed}},this.setQuoteFeed(e),this.resetRenderingParameters()}};a.Pz}}]);